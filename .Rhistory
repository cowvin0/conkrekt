library(tidymodels)
library(ggplot2)
cor_matrix <- teste |> cor()
cor_matrix
corrplot(tl.col = "black", method = "ellipse")
cor_matrix |> corrplot(tl.col = "black", method = "ellipse")
cor_matrix |> corrplot()
data |> colnames()
concrete <- concrete |> rename(
c(
cement = cimento,
blast_furnace_slag = escória_de_aço,
fly_ash = cinzas_pulverizadas,
water = água,
superplasticizer = superplastificante,
coarse_aggregate = agregado_graúdo,
age = tempo,
compressive_strength = força_compressiva)
)
concrete <- concrete |> rename(
c(
cement = cimento,
blast_furnace_slag = escória_de_aço,
fly_ash = cinzas_pulverizadas,
water = água,
superplasticizer = superplastificante,
coarse_aggregate = agregado_graúdo,
age = tempo,
compressive_strength = força_compressiva)
)
concrete <- concrete |> rename(
cement = cimento,
blast_furnace_slag = escória_de_aço,
fly_ash = cinzas_pulverizadas,
water = água,
superplasticizer = superplastificante,
coarse_aggregate = agregado_graúdo,
age = tempo,
compressive_strength = força_compressiva)
concrete <- concrete |> rename(
cement = "cimento",
blast_furnace_slag = "escória_de_aço",
fly_ash = "cinzas_pulverizadas",
water = "água",
superplasticizer = "superplastificante",
coarse_aggregate = "agregado_graúdo",
age = "tempo",
compressive_strength = "força_compressiva"
)
concrete <- concrete |> rename(
"cement" = "cimento",
"blast_furnace_slag" = "escória_de_aço",
"fly_ash" = "cinzas_pulverizadas",
"water" = "água",
"superplasticizer" = "superplastificante",
"coarse_aggregate" = "agregado_graúdo",
"age" = "tempo",
"compressive_strength" = "força_compressiva"
)
concrete
concrete
concrete <- concrete |> rename(
# "cement" = "cimento",
"blast_furnace_slag" = "escória_de_aço",
"fly_ash" = "cinzas_pulverizadas",
"water" = "água",
"superplasticizer" = "superplastificante",
"coarse_aggregate" = "agregado_graúdo",
"age" = "tempo",
"compressive_strength" = "força_compressiva"
)
concrete <- concrete |> rename(
cimento = cement,
escória_de_aço = blast_furnace_slag,
cinzas_pulverizadas = fly_ash,
água = water,
superplastificante = superplasticizer,
agregado_graúdo = coarse_aggregate,
tempo = age,
força_compressiva = compressive_strength
)
concrete
#| output: false
library(tidyverse)
library(tidymodels)
data <- concrete
data |>
ggplot(aes(x = cement)) +
geom_density() +
theme()
data <- concrete
data <- concrete
data
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
# step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash,degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) ->modelo
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
# step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
# step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
# step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
```{r}
data
data$fly_ash |> unique()
data$fly_ash |> count()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement,
) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement,
) |>
step_rm(coarse_aggregate, fine_aggregate, cement, water) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement,
) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement,
) |>
step_rm(coarse_aggregate, fine_aggregate) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement,
) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement,
) |>
step_rm(coarse_aggregate, fine_aggregate) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement,
) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement,
) |>
step_rm(coarse_aggregate, fine_aggregate, cement, wc) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement,
) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, -wc, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement,
) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash,  degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement,
) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, -wc, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement,
) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement,
) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, -wc, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement,
) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash,  degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> #->modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_mutate(wc = water / cement,
) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, -wc, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) -> modelo
data |>
ggplot(aes(x = compressive_strength, y = predict(modelo))) +
geom_point() +
geom_abline()+
coord_obs_pred() +
theme_bw()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_BoxCox(all_numeric_predictors()) |>
step_mutate(wc = water / cement,
) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, -wc, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) -> modelo
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_bs(all_numeric_predictors()) |>
step_mutate(wc = water / cement,
) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, -wc, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) -> modelo
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_bs(all_numeric_predictors()) |>
step_mutate(wc = water / cement
) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, -wc, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) -> modelo
# step_rm(coarse_aggregate, fine_aggregate, cement) |>
# step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
# step_poly(all_numeric_predictors(), -fly_ash, -wc, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) -> modelo
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_bs(all_numeric_predictors()) |>
# step_mutate(wc = water / cement
# ) |>
# step_rm(coarse_aggregate, fine_aggregate, cement) |>
# step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
# step_poly(all_numeric_predictors(), -fly_ash, -wc, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) -> modelo
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_bs(all_numeric_predictors()) |>
# step_mutate(wc = water / cement
# ) |>
# step_rm(coarse_aggregate, fine_aggregate, cement) |>
# step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
# step_poly(all_numeric_predictors(), -fly_ash, -wc, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> # -> modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_mutate(wc = water / cement) |>
step_bs(all_numeric_predictors()) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, -wc, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> # -> modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_mutate(wc = water / cement) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_bs(all_numeric_predictors()) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), -fly_ash, -wc, degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> # -> modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_mutate(wc = water / cement) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_bs(all_numeric_predictors()) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) |> # -> modelo
summary()
data |>
recipe(compressive_strength ~ .) |>
step_rm(superplasticizer) |>
step_mutate(wc = water / cement) |>
step_rm(coarse_aggregate, fine_aggregate, cement) |>
step_bs(all_numeric_predictors()) |>
step_interact(~ all_numeric_predictors() : all_numeric_predictors()) |>
step_poly(all_numeric_predictors(), degree = 2) |>
prep() |>
bake(data) |>
lm(compressive_strength ~ ., data = _) -> modelo
data |>
ggplot(aes(x = compressive_strength, y = predict(modelo))) +
geom_point() +
geom_abline()+
coord_obs_pred() +
theme_bw()
